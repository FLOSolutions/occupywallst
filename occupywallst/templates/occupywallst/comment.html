{% load comments %}

{% if not comment.is_deleted or comment.replies %}
  <div class="comment" id="comment-{{ comment.id }}">
    <div class="content">
      {% if comment.is_deleted %}
        <p class="deleted"><span>This comment was deleted D:</span></p>
      {% else %}
        <div class="arrows">
          <a class="up {% if comment.upvoted %}upvoted{% endif %}" href="#">↥</a><br />
          <a class="down {% if comment.downvoted %}downvoted{% endif %}" href="#">↧</a>
        </div>
        <div class="info">
          <a href="{{ comment.user.get_absolute_url }}">
            {{ comment.user.username }}</a>
          ({{ comment.user.userinfo.city }}, {{ comment.user.userinfo.region }})
          <span class="karma">{{ comment.karma }}</span> points
          <span class="published">{{ comment.published|timesince }}</span> ago
          (<span class="ups">{{ comment.ups }}</span>|<span class="downs">{{ comment.downs }}</span>)
        </div>
        <div class="words {% if comment.is_removed %}removed{% endif %}">
          {{ comment.content|linebreaks }}
        </div>
        <div class="links">
          <a class="reply" href="#">reply</a>
          <a href="{{ comment.get_absolute_url }}">permalink</a>
          {% if comment.user == user %}
            <a class="delete" href="#">delete</a>
          {% endif %}
          {% if user.is_staff %}
            <a class="remove" href="#">{% if comment.is_removed %}un{% endif %}remove</a>
          {% endif %}
        </div>
      {% endif %}
    </div>
    <div class="replies">
      {% show_comments user comment.replies %}
    </div>
  </div>
{% endif %}
